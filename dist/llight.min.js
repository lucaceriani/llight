class LLight{debugEnabled=!1;isInitialized=!1;forId=[];$={};constructor(e=!1){this.debugEnabled=e}update(firstTime=!1){let ts=performance.now();const qa=e=>document.querySelectorAll(e);if(firstTime?this.dbg("Called llight() first time!"):this.dbg("Called llight()"),firstTime){for(let e of qa("[ll-for]"))e.setAttribute("ll-for-id",this.forId.length),this.forId.push(e.firstElementChild.cloneNode(!0));for(let e of qa("[ll-self]")){let t=e.getAttribute("ll-self");t||(t=e.getAttribute("id")),t?this.$.hasOwnProperty(t)?console.error(`llight: Trying to self-bind with name "${t}" but it already exists!`):this.$[t]=e:console.error('llight: No attribute for "ll-self" or "id"')}for(let e of qa("[ll-bind]"))e.addEventListener("input",(e=>this.bind(e)));for(let e of qa("[ll-\\@click]"))e.addEventListener("click",(e=>this.click(e)));for(let e of qa("[ll-\\@enter]"))e.addEventListener("keydown",(e=>this.enter(e)));window.addEventListener("hashchange",(e=>this.renderRoute()))}for(let node of qa("[ll-bind]")){let variable=eval(node.getAttribute("ll-bind"));node.value=variable}for(let node of qa("[ll-text]"))node.innerText=eval(node.getAttribute("ll-text"));for(let node of qa("[ll-class]")){let arr=node.getAttribute("ll-class").split(":");2==arr.length?eval(arr[1])?node.classList.add(arr[0]):node.classList.remove(arr[0]):console.error('ll-class must be in form: "class:expression"')}for(let node of qa("[ll-show]")){let expr=node.getAttribute("ll-show");eval(expr)?node.style.display="":node.style.display="none"}for(let e of qa("a[ll-goto")){let t=e.getAttribute("ll-goto");t.startsWith("/")||(t=`/${t}`),e.href=`#${t}`}for(let node of qa("[ll-for]")){let arr=eval(node.getAttribute("ll-for")),childId=parseInt(node.getAttribute("ll-for-id"));node.innerHTML="";for(let e of arr){let t=this.forId[childId].cloneNode(!0);node.appendChild(t),(t.querySelector("[ll-for-here]")||t).innerText=e}}firstTime&&(location.hash="#/"),this.renderRoute(),firstTime?document.body.dispatchEvent(new Event("llight.initialized")):document.body.dispatchEvent(new Event("llight.updated"));let te=performance.now();this.dbg(`It took ${(te-ts).toFixed(3)}ms`)}renderRoute(){let e=location.hash.substr(1);document.querySelectorAll(`[ll-route="${e}"]`).forEach((e=>e.style.display="")),document.querySelectorAll(`[ll-route]:not([ll-route="${e}"])`).forEach((e=>e.style.display="none"))}click(e){let evalString=e.target.getAttribute("ll-@click");eval(evalString),this.update()}enter(e){"Enter"===e.key&&(eval(e.target.getAttribute("ll-@enter")),this.update())}bind(e){let variable=e.target.getAttribute("ll-bind");eval(`${variable} = ${JSON.stringify(e.target.value)}`),this.update()}dbg(e){this.debugEnabled&&console.log(e)}}if(ll)console.error("llight: LLight cannot be initialized, 'll' already exists");else{var ll=new LLight(!0);document.addEventListener("DOMContentLoaded",(()=>ll.update(!0)))}
